<html>
    <head>
        <link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css"
   integrity="sha512-xodZBNTC5n17Xt2atTPuE1HxjVMSvLVW9ocqUKLsCC5CXdbqCmblAshOMAS6/keqq/sMZMZ19scR4PsZChSR7A=="
   crossorigin=""/>
   <script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js"
   integrity="sha512-XQoYMqMTK8LvdxXYG3nZ448hOEQiglfqkJs1NOQV44cWnUrBc8PkAOcXy20w0vlaXaVUearIOBhiXZ5V3ynxwA=="
   crossorigin=""></script>
        
    </head>
    <body style="background-color:gray">
        <h1 style="font-family: helvetica; font-weight:100">Car Telemetry
        </h1>
        <div style="height:900px">
        <canvas style="height:300px;width:30%;display:inline-block;background-color: black;" id="myChart1"></canvas>
        <canvas style="height:300px;width:30%;display:inline-block;background-color: black;" id="myChart2"></canvas>
        <canvas style="height:300px;width:30%;display:inline-block;background-color: black;" id="myChart3"></canvas>
        <canvas style="height:300px;width:30%;display:inline-block;background-color: black;" id="myChart4"></canvas>
        <!-- <div style="height:500px;width:50%;display:inline-block" id="mapid"></div> -->
        <img style="height:500px;width:50%;display:inline-block" src="/public/image.png">
        </div>
        <p>Console Log</p>
        <div style="width:100%;height:150px;background-color: white;">
        <p><em>14:20:52</em> startup</p>
        
        </div>
        
        <canvas id="mychart3"></canvas>

    </body>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@2.8.0"></script>
    <script src="/socket.io/socket.io.js"></script>
    <script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
    <script>
        var ctx = document.getElementById('myChart1').getContext('2d');
        var myLineChart1 = new Chart(ctx, {
        // The type of chart we want to create
    type: 'line',

// The data for our dataset
data: {
    labels: [,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
    ,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,],
    datasets: [{
        label: 'Speed m/s',
        borderColor: 'rgb(255, 99, 132)',
        data: [,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
        ,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,],
        
    }]
},

// Configuration options go here
options: {
    responsive:false,
    elements:{
        line:{
            tension:0
        },
        point:{
            radius:0
        }
    },
    animation: {
        duration:0
    }
}
        });
        var ctx = document.getElementById('myChart2').getContext('2d');
        var myLineChart2 = new Chart(ctx, {
        // The type of chart we want to create
    type: 'line',

// The data for our dataset
data: {
    labels: [,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
    ,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,],
    datasets: [{
        label: 'Acceleration m/s^2',
        borderColor: 'rgb(20, 255, 132)',
        data: [,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
        ,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,],
        linetension:1
    }]
},

// Configuration options go here
options: {
    responsive:false,
    elements:{
        line:{
            tension:0
        },
        point:{
            radius:0
        }
    },
    animation: {
        duration:0
    }
}
        });
        var ctx = document.getElementById('myChart3').getContext('2d');
        var myLineChart3 = new Chart(ctx, {
        // The type of chart we want to create
    type: 'line',

// The data for our dataset
data: {
    labels: [,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
    ,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,],
    datasets: [{
        label: 'Battery V',
        borderColor: 'rgb(20, 135, 255)',
        data: [,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
        ,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,],
        linetension:1
    }]
},

// Configuration options go here
options: {
    responsive:false,
    elements:{
        line:{
            tension:0
        },
        point:{
            radius:0
        },
        
    },
    animation: {
        duration:0
    }
}
        });
        var ctx = document.getElementById('myChart4').getContext('2d');
        var myLineChart4 = new Chart(ctx, {
        // The type of chart we want to create
    type: 'line',

// The data for our dataset
data: {
    labels: [,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
    ,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,],
    datasets: [{
        label: 'Acceleration M/s^2',
        borderColor: 'rgb(255, 255, 132)',
        data: [,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
        ,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,],
        linetension:1
    }]
},

// Configuration options go here
options: {
    responsive:false,
    elements:{
        line:{
            tension:0
        },
        point:{
            radius:0
        }
    },
    animation: {
        duration:0
    }
}
        });

function buttonPressed(){
    update(10, '14:00');
}

function update(data, label, chart){
    chart.data.datasets[0].data.push(data);
    chart.data.datasets[0].data.shift();
    chart.data.labels.push(label);
    chart.data.labels.shift();
    chart.update();
}


var i = 1;

function myLoop() {         //  create a loop function
  setTimeout(function() {   //  call a 3s setTimeout when the loop is called
    update(10,"14:0" + i);   //  your code here
    i++;                    //  increment the counter
    if (i < 20) {           //  if the counter < 10, call the loop function
      myLoop();             //  ..  again which will trigger another 
    }                       //  ..  setTimeout()
  }, 1000)
}

var socket = io();
socket.on('new-data', function(msg){
    console.log(msg);
    update(msg.data[0], msg.data[3], myLineChart1);
    update(msg.data[1], msg.data[3], myLineChart2);
    update(msg.data[2], msg.data[3], myLineChart3);
    // update(msg.data[0], '14:05', myLineChart4);
})



    </script>
    <script>
        var mymap = L.map('mapid').setView([52.0715, -1.0157],14.3);
        L.tileLayer('https://api.mapbox.com/styles/v1/{id}/tiles/{z}/{x}/{y}?access_token={accessToken}', {
    attribution: 'Map data &copy; <a href="https://www.openstreetmap.org/">OpenStreetMap</a> contributors, <a href="https://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, Imagery Â© <a href="https://www.mapbox.com/">Mapbox</a>',
    maxZoom: 18,
    id: 'mapbox/streets-v11',
    tileSize: 512,
    zoomOffset: -1,
    accessToken: 'pk.eyJ1IjoibWJoMTYyMCIsImEiOiJjankwb244aWgwNHd1M2dsYWtkd2h2NWdwIn0.74tfwmTddrE7BpzyAA-0hw'
}).addTo(mymap);
    </script>
    
    
</html>

