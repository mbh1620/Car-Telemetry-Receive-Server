<!-- This file is the main window for viewing the graphs -->
<%- include ('./partials/dashboard.ejs') %>


<html>

<head>
    <script src="https://cdn.jsdelivr.net/npm/p5@1.1.9/lib/p5.js"></script>
    <!-- <script src="scripts/sketch.js" type="text/javascript"></script> -->
    
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css"
        integrity="sha512-xodZBNTC5n17Xt2atTPuE1HxjVMSvLVW9ocqUKLsCC5CXdbqCmblAshOMAS6/keqq/sMZMZ19scR4PsZChSR7A=="
        crossorigin="" />
    <link rel="stylesheet" href="./stylesheets/standard-style.css">
    <script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js"
        integrity="sha512-XQoYMqMTK8LvdxXYG3nZ448hOEQiglfqkJs1NOQV44cWnUrBc8PkAOcXy20w0vlaXaVUearIOBhiXZ5V3ynxwA=="
        crossorigin=""></script>

</head>

<body>
    <div style="height:92.5vh;overflow: hidden;">
        <div style="width:95%;height:auto;margin-bottom:20px;">
        <img src="/public/uon.png" style="height:auto;width:200px;display:block-inline;margin-top:20px;float:right;">
        <h1 style="font-family: helvetica; font-weight:100;display:inline-block;color:white;margin-left:50px;margin-top:30px">Accumulator Data
        </h1>
        </div>
        
        <!-- https://stackoverflow.com/questions/45149062/chart-js-how-to-show-cursor-pointer-for-labels-legends-in-line-chart USE this for cursor -->
        <div style="height:72.5%">



            <div class="width:100%">
                <div class="jumbotron" style="height:400px;width:25%;display;float:left;display:inline-block;padding-top:30px"><h4>Brick 1</h4>
                    <canvas style="background-color: transparent;height:60%;width:100%"
                    id="myChart1"></canvas>
                    <p>Average Brick Temperature (ºC): </p>
                    <p>Temperature Range (ºC): </p>
                    <p>Average Brick Voltage (V): </p>
                    <p>Voltage Range (V): </p>
                
                </div>
                <div class="jumbotron" style="height:400px;width:25%;display;float:left;display:inline-block;padding-top:30px"><h4>Brick 2</h4>
                    <canvas style="background-color: transparent;height:60%;width:100%"
                    id="myChart2"></canvas>
                    <p>Average Brick Temperature (ºC): </p>
                    <p>Temperature Range (ºC): </p>
                    <p>Average Brick Voltage (V): </p>
                    <p>Voltage Range (V): </p></div>
                <div class="jumbotron" style="height:400px;width:25%;display;float:left;display:inline-block;padding-top:30px"><h4>Brick 3</h4>
                    <canvas style="background-color: transparent;height:60%;width:100%"
                    id="myChart3"></canvas>
                    <p>Average Brick Temperature (ºC): </p>
                    <p>Temperature Range (ºC): </p>
                    <p>Average Brick Voltage (V): </p>
                    <p>Voltage Range (V): </p></div>
                <div class="jumbotron" style="height:400px;width:25%;display;float:left;display:inline-block;padding-top:30px"><h4>Brick 4</h4>
                    <canvas style="background-color: transparent;height:60%;width:100%"
                    id="myChart4"></canvas>
                    <p>Average Brick Temperature (ºC): </p>
                    <p>Temperature Range (ºC): </p>
                    <p>Average Brick Voltage (V): </p>
                    <p>Voltage Range (V): </p></div>
            </div>
            <div class="width:100%">
                <div class="jumbotron" style="height:400px;width:25%;display;float:left;display:inline-block;padding-top:30px"><h4>Brick 5</h4>
                    <canvas style="background-color: transparent;height:60%;width:100%"
                    id="myChart5"></canvas>
                    <p>Average Brick Temperature (ºC): </p>
                    <p>Temperature Range (ºC): </p>
                    <p>Average Brick Voltage (V): </p>
                    <p>Voltage Range (V): </p></div>
                <div class="jumbotron" style="height:400px;width:25%;display;float:left;display:inline-block;padding-top:30px"><h4>Brick 6</h4>
                    <canvas style="background-color: transparent;height:60%;width:100%"
                    id="myChart6"></canvas>
                    <p>Average Brick Temperature (ºC): </p>
                    <p>Temperature Range (ºC): </p>
                    <p>Average Brick Voltage (V): </p>
                    <p>Voltage Range (V): </p></div>
                <div class="jumbotron" style="height:400px;width:25%;display;float:left;display:inline-block;padding-top:30px"><h4>Brick 7</h4>
                    <canvas style="background-color: transparent;height:60%;width:100%"
                    id="myChart7"></canvas>
                    <p>Average Brick Temperature (ºC): </p>
                    <p>Temperature Range (ºC): </p>
                    <p>Average Brick Voltage (V): </p>
                    <p>Voltage Range (V): </p></div>
                <div class="jumbotron" style="height:400px;width:25%;display;float:left;display:inline-block;padding-top:30px"><h4>Brick 8</h4>
                    <canvas style="background-color: transparent;height:60%;width:100%"
                    id="myChart8"></canvas>
                    <p>Average Brick Temperature (ºC): </p>
                    <p>Temperature Range (ºC): </p>
                    <p>Average Brick Voltage (V): </p>
                    <p>Voltage Range (V): </p></div>
            </div>
        </div>
    </div>
<div style="height:30px;margin-top:20px;text-align:center;font-size: 15;color:white;font-family: Arial, Helvetica, sans-serif;">Instructions are at <a style="color:blue" href="https://github.com/mbh1620/Car-Telemetry-Receive-Server">https://github.com/mbh1620/Car-Telemetry-Receive-Server</a></div>
</body>
<script src="https://cdn.jsdelivr.net/npm/chart.js@2.8.0"></script>
<script src="/socket.io/socket.io.js"></script>
<script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
<script src="/scripts/Accum-Charts.js" ></script>
<script src="/scripts/functions.js" ></script>

<script>

    function buttonPressed() {
        update(10, '14:00');
    }

    function update(data, label, chart) {
        chart.data.datasets[0].data.push(data);
        chart.data.datasets[0].data.shift();
        chart.data.labels.push(label);
        chart.data.labels.shift();
        chart.update();
    }

    function updateBarChart(data1, data2, barChart){

        barChart.data.datasets[0].data = [data1, data2]
        
        barChart.update()
    }

    var socket = io();
    socket.emit("ACC");
    socket.on('acc-data', function (msg) {
        console.log(msg);
        //update brick1
        updateBarChart(msg.data[0], msg.data[2], myBarChart1);
        //update brick2
        updateBarChart(msg.data[4], msg.data[6], myBarChart2);
        //update brick3
        updateBarChart(msg.data[8], msg.data[10], myBarChart3);
        //update brick4
        updateBarChart(msg.data[12], msg.data[14], myBarChart4);
        //update brick5
        updateBarChart(msg.data[16], msg.data[18], myBarChart5);
        //update brick6
        updateBarChart(msg.data[20], msg.data[22], myBarChart6);
        //update brick7
        updateBarChart(msg.data[24], msg.data[26], myBarChart7);
        //update brick8
        updateBarChart(msg.data[28], msg.data[30], myBarChart8);
    })



</script>
</html>