<!-- This file is the main window for viewing the graphs -->

<%- include ('./partials/dashboard.ejs') %>


<html>

<head>
    <script src="https://cdn.jsdelivr.net/npm/p5@1.1.9/lib/p5.js"></script>
    <!-- <script src="scripts/sketch.js" type="text/javascript"></script> -->
    
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css"
        integrity="sha512-xodZBNTC5n17Xt2atTPuE1HxjVMSvLVW9ocqUKLsCC5CXdbqCmblAshOMAS6/keqq/sMZMZ19scR4PsZChSR7A=="
        crossorigin="" />
    <link rel="stylesheet" href="../../stylesheets/standard-style.css">
    <script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js"
        integrity="sha512-XQoYMqMTK8LvdxXYG3nZ448hOEQiglfqkJs1NOQV44cWnUrBc8PkAOcXy20w0vlaXaVUearIOBhiXZ5V3ynxwA=="
        crossorigin=""></script>

</head>

<body>
    <div style="height:92.5vh;overflow: hidden;">
        <div style="width:95%;height:auto;margin-bottom:20px;">
        <img src="/public/uon.png" style="height:auto;width:200px;display:block-inline;margin-top:20px;float:right;">
        <h1 style="font-family: helvetica; font-weight:100;display:inline-block;color:white;margin-left:50px;margin-top:30px">Loaded Primary Data
        </h1>
        </br>
        <em style="color:white;margin-left:50px">Session Name: <%= session.name %></em>
        <em style="color:white;margin-left:50px">Date Created: <%= session.dateCreated %></em>
        </div>
        <button class="btn btn-md btn-success" onclick="window.location.href = '/session/POS/<%= session._id %>'">Map Data</button>
        <button class="btn btn-md btn-primary" onclick="screenshot()">Screenshot</button>
        <!-- https://stackoverflow.com/questions/45149062/chart-js-how-to-show-cursor-pointer-for-labels-legends-in-line-chart USE this for cursor -->
        <div id="canvas-div" style="height:72.5%">
            <div style="height:40%;width:100%;margin: 0 auto;">
            <canvas style="background-color: black;height:100%;width:100%"
                id="myChart1"></canvas>
            </div>
            <div style="height:40%;width:100%;margin: 0 auto">
            <!-- <input type="range" id="slider2" orient="vertical"
                style="display:inline-block;-webkit-appearance: slider-vertical;width:10px;height:25%"> -->
            <canvas style="background-color: black;height:100%;width:100%"
                id="myChart2"></canvas>
            </div>
            <!-- <input type="range" id="slider3" orient="vertical"
                style="display:inline-block;-webkit-appearance: slider-vertical;width:10px;height:25%"> -->
            <div style="height:40%;width:100%;margin: 0 auto;">
            <canvas style="background-color: black;height:100%;width:100%"
                id="myChart3"></canvas>
            </div>
            <a id="url" download style="display:none">
        </div>
        <input type="range" max="100" min="0">
    </div>
<div style="height:30px;margin-top:20px;text-align:center;font-size: 15;color:white;font-family: Arial, Helvetica, sans-serif;">Instructions are at <a style="color:blue" href="https://github.com/mbh1620/Car-Telemetry-Receive-Server">https://github.com/mbh1620/Car-Telemetry-Receive-Server</a></div>
</body>
<script src="https://cdn.jsdelivr.net/npm/chart.js@2.8.0"></script>
<script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
<script src="/scripts/loaded-prim-charts.js" ></script>
<script src="/scripts/functions.js" ></script>

<script>

    function screenshot(){
        //take screenshots of the graphs
        console.log("hello");
        var url = myLineChart2.toBase64Image()
        document.getElementById("url").href=url;
        document.getElementById('url').click();
    }

    function buttonPressed() {
        update(10, '14:00');
    }

    function update(data, label, chart) {
        chart.data.datasets[0].data.push(data);
        chart.data.datasets[0].data.shift();
        chart.data.labels.push(label);
        chart.data.labels.shift();
        chart.update();
    }

    <% for(var i = 0; i < 250; i++){ %>
        update('<%=session.PRIData[i][0]%>','<%=session.PRIData[i][3]%>', myLineChart1)
        update('<%=session.PRIData[i][1]%>','<%=session.PRIData[i][3]%>', myLineChart2)
        update('<%=session.PRIData[i][2]%>','<%=session.PRIData[i][3]%>', myLineChart3)
    <% } %>

    //We need a function to scroll through data and to zoom in or out of data


</script>
</html>