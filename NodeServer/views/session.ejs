<!-- This file is the main window for viewing the graphs -->
<%- include ('./partials/dashboard.ejs') %>

<html>

<head>
</head>

<body>
    <div style="height:92.5vh;overflow: hidden;">
        <div style="width:95%;height:auto;margin-bottom:20px;">
        <img src="/public/uon.png" style="height:auto;width:200px;display:block-inline;margin-top:20px;float:right;">
        <h1 style="font-family: helvetica; font-weight:100;display:inline-block;color:white;margin-left:50px;margin-top:30px">Session Saver/Loader
        </h1></br>
        
        
        </div>
        <div class="jumbotron bg-dark" style="width:80%;margin:0 auto;height:80vh">
            <div class="btn btn-md btn-primary" onclick="start()">Start Data Session</div>
            <div class="btn btn-md btn-warning" onclick="stop()">Save</div>
        </br>
            <input class="" id="name-input" style="font-size: 18;font-family: helvetica;font-weight: 100;margin-top:40px" type="text" placeholder="Session Name">
            <div class="bg-secondary" style="height:80%;width:90%;margin:0 auto;margin-top:30px;padding-top:10px;overflow:scroll">
            <% for(var i = 0; i < sessions.length; i++){ %>
                <div id="session<%= i %>" style="height:50px;background-color: white;margin-top:10px;margin-left:10px;margin-right:10px;"><p style="margin-left:10px;display:inline-block"><%= sessions[i].name %></p><p style="margin-left:10px;display:inline-block"><%=sessions[i].dateCreated%></p><p style="margin-left:10px;display:inline-block"><%= sessions[i].size %> GB</p><button style="float:right;display:inline-block;margin-top:6px;margin-right:30px" onclick="delete_session('<%= sessions[i]._id %>', <%= i %>)" class="btn btn-md btn-danger">Delete</button><button style="float:right;display:inline-block;margin-top:6px;margin-right:2px" class="btn btn-md btn-success">Load</button></div>
            <% } %>
            
            </div>
        </div>
    </div>
<div style="height:30px;margin-top:20px;text-align:center;font-size: 15;color:white;font-family: Arial, Helvetica, sans-serif;">Instructions are at <a style="color:blue" href="https://github.com/mbh1620/Car-Telemetry-Receive-Server">https://github.com/mbh1620/Car-Telemetry-Receive-Server</a></div>
</body>

</html>
<script>
    function start(){
        $.ajax({
            type:"GET",
            url: "/start-data-session"
        })
    }

    function stop(){
        var sessionName = $('#name-input').val();
        if(sessionName == ""){
            alert("Please input a session name and try again!");
            return 0;
        }
        $.ajax({
            type:"GET",
            url: "/stop-data-session/" + sessionName
        })
    }

    function delete_session(id, num){
        $.ajax({
            type:"POST",
            url: "/session/delete/"+id
        })
        //Remove element using jquery
        var string = "#session"+num;
        $(string).remove();
    }

    function load(id){
        
    }

</script>